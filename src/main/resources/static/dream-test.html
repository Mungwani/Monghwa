<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>ëª½í™” ğŸŒ™ AI ê¿ˆ í•´ëª½</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&display=swap');

        body {
            font-family: "Pretendard", sans-serif;
            background: linear-gradient(180deg, #f4f1ff 0%, #fafafa 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding-top: 80px;
            color: #333;
            overflow-x: hidden;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #5e4ae3;
            text-shadow: 0 2px 6px rgba(94, 74, 227, 0.2);
            letter-spacing: -0.5px;
            margin-bottom: 20px;
        }

        .card {
            width: 420px;
            background: #fff;
            border-radius: 20px;
            padding: 30px 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(94, 74, 227, 0.12);
        }

        textarea {
            width: 100%;
            height: 120px;
            font-size: 15px;
            padding: 12px 14px;
            border-radius: 10px;
            border: 1px solid #ccc;
            resize: none;
            outline: none;
            transition: border 0.2s ease;
        }

        textarea:focus {
            border-color: #5e4ae3;
            box-shadow: 0 0 0 2px rgba(94, 74, 227, 0.1);
        }

        select {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #bbb;
            font-size: 14px;
            margin-top: 12px;
            outline: none;
            transition: border 0.2s ease;
        }

        select:focus {
            border-color: #5e4ae3;
        }

        button {
            width: 100%;
            padding: 12px;
            margin-top: 16px;
            background-color: #5e4ae3;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }

        button:hover {
            background-color: #4b3acb;
            transform: translateY(-1px);
        }

        #result {
            width: 420px;
            background: #fff;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
            margin-top: 28px;
            line-height: 1.7;
            white-space: pre-line;
        }

        #imageContainer {
            width: 420px;
            text-align: center;
            margin-top: 24px;
        }

        #imageContainer img {
            width: 100%;
            border-radius: 16px;
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.15);
            opacity: 0;
            transition: opacity 1.2s ease-in;
        }

        #imageContainer img.show {
            opacity: 1;
        }

        footer {
            margin-top: 60px;
            color: #999;
            font-size: 13px;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>
</head>
<body>
<h1>ëª½í™” ğŸŒ™</h1>
<h3>AI ê¿ˆ í•´ëª½</h3>

<div class="card">
    <textarea id="dreamInput" placeholder="ex) ì‚¬ê³¼ë‚˜ë¬´ì— ìœ ë… ë¹›ë‚˜ëŠ” í™©ê¸ˆ ì‚¬ê³¼ê°€ í•˜ë‚˜ ìˆì—ˆëŠ”ë° ê·¸ê±¸ ë”°ëŠ” ê¿ˆì„ ê¿¨ì–´"></textarea>
    <h3>AI ì´ë¯¸ì§€ì˜ í™”í’ì„ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
    <select id="styleSelect">
        <option value="ìˆ˜ì±„í™”">ğŸ¨ ìˆ˜ì±„í™”í’</option>
        <option value="ì• ë‹ˆë©”ì´ì…˜">ğŸ–¼ ì• ë‹ˆë©”ì´ì…˜í’</option>
        <option value="ì‚¬ì´ë²„í‘í¬">ğŸŒŒ ì‚¬ì´ë²„í‘í¬</option>
        <option value="í”½ì…€ì•„íŠ¸">ğŸŒ  í”½ì…€ì•„íŠ¸</option>
        <option value="ì‚¬ì‹¤ì ì¸">ğŸ“· ì‚¬ì‹¤ì ì¸ í™”í’</option>
    </select>
    <button onclick="sendDream()">ì‹œì‘í•˜ê¸°</button>
</div>

<div id="result"></div>
<div id="imageContainer"></div>

<footer>Â© 2025 ëª½í™”(Monghwa) | AI Dream Interpretation</footer>

<script>
    const md = window.markdownit({ breaks: true });

    async function sendDream() {
        const dreamText = document.getElementById("dreamInput").value.trim();
        const style = document.getElementById("styleSelect").value;
        const resultEl = document.getElementById("result");
        const imageContainer = document.getElementById("imageContainer");

        if (!dreamText) return alert("ğŸŒ™ ê¿ˆ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");

        resultEl.textContent = "AIê°€ ê¿ˆì„ í•´ì„ ì¤‘ì…ë‹ˆë‹¤... â³";
        imageContainer.innerHTML = "";

        try {
            // 1ï¸âƒ£ í•´ëª½ ìš”ì²­
            const res = await fetch("http://localhost:8080/api/dream", {
                method: "POST",
                headers: { "Content-Type": "text/plain; charset=utf-8" },
                body: dreamText,
            });
            const text = await res.text();
            resultEl.innerHTML = md.render(text);

            // 2ï¸âƒ£ ì´ë¯¸ì§€ ìƒì„± ìš”ì²­
            const waitMsg = document.createElement("p");
            waitMsg.textContent = `ğŸŒ™ ${style} ìŠ¤íƒ€ì¼ë¡œ ì‹œê°í™” ì¤‘ì…ë‹ˆë‹¤... ğŸ¨`;
            waitMsg.style.marginTop = "10px";
            imageContainer.appendChild(waitMsg);

            const imgRes = await fetch("http://localhost:8080/api/dream/image", {
                method: "POST",
                headers: { "Content-Type": "application/json; charset=utf-8" },
                body: JSON.stringify({ text: dreamText, style }),
            });

            const imageData = await imgRes.text();
            if (imageData.startsWith("data:image")) {
                const img = document.createElement("img");
                img.src = imageData;
                img.onload = () => img.classList.add("show");
                imageContainer.innerHTML = `<h3>âœ¨ ${style} ìŠ¤íƒ€ì¼ AI ì´ë¯¸ì§€</h3>`;
                imageContainer.appendChild(img);
            } else {
                imageContainer.textContent = "âš ï¸ ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨: " + imageData;
            }
        } catch (e) {
            resultEl.textContent = "âš ï¸ ì˜¤ë¥˜ ë°œìƒ: " + e.message;
        }
    }
</script>
</body>
</html>
